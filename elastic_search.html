
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
	<link rel="icon" type="image/png" sizes="96x96" href="assets/img/brain_photo.jpg">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Dragomir Developement - Eleastic Search</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <link href="assets/css/bootstrap.css" rel="stylesheet" />
    <link href="assets/css/gaia.css" rel="stylesheet"/>
	<!-- Prism - Used for code highlighting -->
	<link href="assets/css/prism.css" rel="stylesheet" />

    <!-- Canonical SEO -->
    <link rel="canonical" href="https://www.dillondragomir.com"/>
    
    <!--     Fonts and icons     -->
    <link href='https://fonts.googleapis.com/css?family=Cambo|Lato:400,700' rel='stylesheet' type='text/css'>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/css/fonts/pe-icon-7-stroke.css" rel="stylesheet">
	<!-- Global Site Tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107753707-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-107753707-1');
	</script>
	
</head>

<body>
	
	<!-- Facebook Javascript SDK-->
	<div id="fb-root"></div>
	<script>(function(d, s, id) {
	  var js, fjs = d.getElementsByTagName(s)[0];
	  if (d.getElementById(id)) return;
	  js = d.createElement(s); js.id = id;
	  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.10&appId=122081298460962";
	  fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));</script>

    <nav class="navbar navbar-default navbar-transparent navbar-fixed-top" color-on-scroll="85">
        <!-- if you want to keep the navbar hidden you can add this class to the navbar "navbar-burger"-->
        <div class="container">
            <div class="navbar-header">
                <button id="menu-toggle" type="button" class="navbar-toggle" data-toggle="collapse" data-target="#example">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar bar1"></span>
                    <span class="icon-bar bar2"></span>
                    <span class="icon-bar bar3"></span>
                </button>
                <a href="http://www.https://www.facebook.com/Dragomir2020/-tim.com" class="navbar-brand">
                    Dragomir Development
                </a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right navbar-uppercase">
                    <li>
                        <a href="index.html">Home</a>
                    </li>
					<!--
					<li>
						<a href="blog-post.html">Blog</a>
					</li>
					-->
					
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <span class="caret"></span></a>
                        <ul class="dropdown-menu dropdown-danger">
							<li>
                                <a href="about-us.html">About</a>
                            </li>
                            <li>
                                <a href="experience.html">Experience</a>
                            </li>
                            <li>
                                <a href="projects.html">Projects</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="pricing.html">Pricing</a>
                    </li>
                    <li>
                        <a href="contact-us.html" class="btn btn-danger btn-fill">Contact Me</a>
                    </li>
                    <li class="dropdown">
                        <a href="#gaia" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-share-alt"></i> Social
                        </a>
                        <ul class="dropdown-menu dropdown-danger">
                            <li>
                                <a id="facebookNav" href="https://www.facebook.com/Dragomir2020/"><i class="fa fa-facebook-square"></i> Facebook</a>
                            </li>
							<li>
								<a id="linkedInNav" href="https://www.linkedin.com/company-beta/25166872/"><i class="fa fa-linkedin-square"></i> LinkedIn</a>
                            </li>
                            <li>
                                <a id="githubNav" href="https://github.com/Dragomir2020"><i class="fa fa-github"></i> Github</a>
                            </li>
                            <li>
                                <a id="googlePlusNav" href="https://plus.google.com/u/0/+DillonDragomir"><i class="fa fa-google-plus"></i> Google</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
    </nav>


    <div class="section section-header-blog">
        <div class="parallax filter filter-color-black">
            <div class="image"
                style="background-image:url('assets/img/kibana_jumbo.jpg')">
            </div>
            <div class="container">
                <div class="content">
                    <h1>Elastic Search Javascript SDK tutorial</h1>
                    <h3 class="subtitle">Get up in running with elastic search.</h3>
                    <div class="separator separator-danger">✻</div>
                </div>
            </div>
        </div>
    </div>
    <div class="section">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <div class="content-blog">
						<h1>Elastic Search</h1>
						<p>Elastic search is a wonderful searchable database that many companies are using to create searchable indexes. In addition, some people my leverage Elastic Search for data science or machine learning applications. This is a general post to show how ingest data two different ways, that will enable a person to visualize the data in kibana.</p>				
						<p>If you are new to elastic search you will need to download Elastic Search and Kibana and create a mapping template. You will then be able to format ingested data in a way that will be organized for effecitve search and visualization.<p>
						<p>Pre-requisites</p>
						<ul>
							<li>
								<a href="https://www.elastic.co/downloads/elasticsearch">Elastic Search Download</a>
							</li>
							<li><a href="https://www.elastic.co/downloads/kibana">Kibana Dashboard Download</a>
							</li>
							<li><a href="elastic_search_mapping_template.html">Data Mapping Template</a>
							</li>
						</ul>
											
						<h2>Realtime data ingestion</h2>
                        
                        <p>Perhaps unsurprisingly, our community wanted to know how. How do these writers write? What time of day do they write, and how frequently? How long does it take? And does it get any easier over time?</p>
                        <p>A. The desire to lose weight is one of the most frequently cited reasons for skipping breakfast. But many observational studies have found that people who skip breakfast are more likely to be overweight. The theory is that they more than make up for the missed calories in the morning by eating more at lunch or snacking all day.</p>
                        <!--<blockquote>
                            <p>Overall, there’s still a similar intake or a lesser intake (of calories) over the whole day.</p>
                            <small>Krista Casazza, PhD, RD.</small>
                        </blockquote>-->
						<h2>Bulk request parsing and ingestion</h2>
                        <p>Another small randomized trial published by Cornell University researchers in Physiology & Behavior in 2013 found that college students ate about 145 calories more at lunch when they ate nothing in the morning than they did on a day when they ate breakfast. Considering that their breakfasts averaged about 625 calories, skipping it still resulted in a savings of about 450 calories by day’s end, according to the study.</p>
                        <p>In the past nine months we’ve hosted over 400 LIVE Chats with entrepreneurs, investors, entertainers, athletes, and thought leaders from every industry imaginable. Many of our guests have written some of the most insightful, entertaining, and thought-provoking books in categories ranging from science fiction and history, to business non-fiction and memoirs.</p>
                        <p>Perhaps unsurprisingly, our community wanted to know how. How do these writers write? What time of day do they write, and how frequently? How long does it take? And does it get any easier over time?</p>
                    </div>
					
<!-- Highlighted Code -->
<pre>
<code class="language-javascript line-numbers">
// Require Dependancies
var elasticsearch = require('elasticsearch'),
 	fs = require('fs'),
	xlsxj = require("xlsx-to-json");

/////////////
//VARIABLES//
/////////////

var Date = "20190806",
	Upload_time = 4,
	Player,
	GameType = "Sample"
	DataType = "Example",
	fileName = Date + "_" + GameType + "_" + DataType;

var globalPlayerInt,
	idSum = 0;

//New json object needs created for each loop of the for loop

// use for loop to get all players

for(var loop = 1; loop < 23; loop++){

	// Need new object each time


	var updatedFileName;
	//Get Player number
	if(loop<10){
		Player = "0" + loop;
	} else {
		Player = loop;
	}

	//Correct fileName
	updatedFileName = Player + "_" + fileName;
	
	// CHECK FILEPATH
	// Make sure the file exists before running data parsing
	if (fs.existsSync("csv/" + updatedFileName + ".xlsx")) {
		  read_file(Player,updatedFileName);

	} else {
		console.log(updatedFileName + " does not exist.");
	}
}

// Done executing for loop index data into ES
afterRetrieval();

// Call function from inside code
function write_file(L,Up,JS) {
	// VERIFY FILEPATH
	fs.writeFile(("json/" + L + "-" + Up + ".json"), JSON.stringify(JS), function (err) {
	  if (err) {
		  return console.log(err);
	  } 
	});
}

function read_file(PlayerR,uFN){
	var json;
	//USES FILEPATH DECLARED ABOVE
	xlsxj({
			input: ("csv/" + uFN + ".xlsx"), 
			output: null //Overwrite this output
		  }, function(err, result) {
			if(err) {
			  console.error(err);
			}else {
			  json = result;
			  add_data(PlayerR, Upload_time, json);
			}

	  	});
}

function add_data(Pl,Ut,json_add) {
	// Loop through json and add needed parameters
	for(var i = 0; i < json_add.length; i++) {
		json_add[i].Date = Date;
		json_add[i].Player = Pl;
		json_add[i].GameType = GameType;
		json_add[i].DataType = DataType;
	}
	// Call write function now
	write_file(Pl,Ut,json_add)
}

// Wait for data to be read parsed and wrote before indexing into elastic search
function afterRetrieval(){
	// For loop for each player
	for(var i = 1; i < 23; i++){
		globalPlayerInt = (i-1);
		//Add zero to beggining if less than 1o
		var Player,
			pubs;
		if(i<10){
			Player = "0" + i;
		} else {
			Player = i;
		}
		//Check whether filepath is valid
		// USES FILEPATH AGAIN
		if (fs.existsSync("json/" + Player + "-" + Upload_time + ".json")) {
				// Read file into variable
				pubs = JSON.parse(fs.readFileSync("json/" + Player + "-" + Upload_time + ".json"));
				// Function call that sends data to ES
				sendES(pubs,Player);
		} else {
				console.log(Player + "_" +  fileName + " does not exist.");
		}

	}
}

// MAKES BULK REQUEST
// Function calls elastic search database
function sendES(pubs,Player){
	// Create new client
	// VERIFY CLIENT IS ON LOCALHOST:9200
	var client = new elasticsearch.Client({  // default is fine for me, change as you see fit
		host: 'localhost:9200'
		//log: 'trace'
	});
	
	var bulk_request = new Array(),
		jsonData;

	jsonData = JSON.stringify({"index":{"_index":"women_soccer","_type":"sample","_id":"1"}});

	
	// Create new array of JSON for bulk request
	for(var j = 0; j < pubs.length; j++){
		bulk_request[j*2] = JSON.parse(jsonData);
		bulk_request[j*2].index._index = "women_soccer";
		bulk_request[j*2].index._type = fileName;
		bulk_request[j*2].index._id = j + idSum;
		//Parse time
		if(pubs[j].Time.substr(9,10) == "PM"){
			// Add 12 to make military time
			pubs[j]['timestamp'] = pubs[j].Date + " " + (parseInt(pubs[j].Time.substr(0,1)) + 12) + pubs[j].Time.substr(2,7);
		} else {
			// Must be AM
			pubs[j]['timestamp'] = pubs[j].Date + " " + pubs[j].Time.substr(0,7);
		}
		//console.log(pubs[j]);
		bulk_request[j*2 + 1] = pubs[j];
		//bulk_request[j*2 + 1]._timestamp = pubs[j].Time;	
	}
	//Bulk request to elastic search index
	client.bulk({
		body: bulk_request
		}, function(error, response) {
			if (error) {
			  console.error(error);
				return;	
		}
		else {
			console.log("Player " + Player + " data ingested.");
		}
	});
	idSum = idSum + pubs.length;
	// Vary important to do or js heap will fill up
	// Delete object
	delete bulk_request
	//delete client;
	delete client;	
}
</code>
</pre>
					
                    <div class="separator separator-danger">✻</div>
					
					<!-- Container for facebook comments plug-in -->
					<div class="fb-comments" data-href="https://www.dillondragomir.com" data-width="100%" data-numposts="5"></div>
					
				</div>
                <div class="col-md-3 col-md-offset-1 text-center">
                    <h3 class="social-title">Author</h3>
                    <div class="author">
                        <div class="avatar avatar-danger">
                            <img alt="..." src="assets/img/dillon.jpg"/>
                        </div>

                        <div class="description text-center">
                            <h3 class="big-text">Dillon</h3>
                            <p class="small-text">Full-stack</p>
                        </div>
                        <div class="social-buttons">
                            <a href="https://www.linkedin.com/company/dragomir2020/" class="btn btn-social btn-simple"><i class="fa fa-linkedin-square"></i></a>
                            <a href="https://plus.google.com/+DillonDragomir" class="btn btn-social btn-simple"><i class="fa fa-google-plus-square"></i></a>
                            <a href="https://www.facebook.com/Dragomir2020/" class="btn btn-social btn-simple"><i class="fa fa-facebook-square"></i></a>
                        </div>
                    </div>
                    <h3 class="social-title">Categories</h3>
                    <span class="label label-fill label-danger">Tech</span>
                    <span class="label label-fill label-danger">Database</span>
                    <span class="label label-fill label-danger">Javascript</span>
                    <span class="label label-fill label-danger">SDK</span>
                    <!--<h3 class="social-title">Shares - 3</h3>
                    <div class="social-buttons-blog-posts">
                        <button class="btn btn-social btn-simple btn-padding"><i class="fa fa-facebook-square"></i></button>
                        <button class="btn btn-social btn-simple btn-padding"><i class="fa fa-twitter"></i></button>
                        <button class="btn btn-social btn-simple btn-padding"><i class="fa fa-instagram"></i></button>
                        <button class="btn btn-social btn-simple btn-padding"><i class="fa fa-google-plus-square" ></i></button>
                    </div> -->
                </div>
            </div>
        </div>
    </div>
	
	


    <!-- <div class="section">
        <div class="container">
            <h3>Comments</h3>
            <div class="row">
                <div class="col-md-8">
                    <div class="media-area">
                        <div class="media">
                            <a href="#" class="avatar avatar-danger pull-left">
                                <img class="media-object" src="../assets/img/faces/face_1.jpg">
                            </a>
                            <div class="media-body">
                                <h3 class="media-heading">Tina Rosa</h3>
                                <h5 class="text-muted pull-right">Mar 23, 09:42 AM</h5>
                                <p>While doing this, I also came up with a name, bought the domain, found a suitable Wordpress theme I could strip to bare essentials, registered Twitter/Facebook and made a lander with an e-mail drop which I managed to get on BetaList and StartupList, two of my favorite tools to get early (possible) users.</p>
                                <p>Don't forget, You're Awesome!</p>
                                <div class="media-footer">
                                    <button class="btn btn-info btn-simple">
                                        <i class="fa fa-reply"></i>
                                        Reply
                                    </button>
                                    <button class="btn btn-danger btn-simple pull-right">
                                        <i class="fa fa-heart"></i>
                                        123
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="media">
                            <a href="#" class="avatar avatar-danger pull-left">
                                <img class="media-object" src="../assets/img/faces/face_3.jpg">
                            </a>
                            <div class="media-body">
                                <h3 class="media-heading">Creative Tim</h3>
                                <h5 class="text-muted pull-right">Mar 23, 09:42 AM</h5>
                                <p>Hello guys, nice to have you on the platform! There will be a lot of great stuff coming soon. We will keep you posted for the latest news.</p>
                                <p>Don't forget, You're Awesome!</p>
                                <div class="media-footer">
                                    <button class="btn btn-info btn-simple">
                                        <i class="fa fa-reply"></i>
                                        Reply
                                    </button>
                                    <button class="btn btn-danger btn-simple pull-right">
                                        <i class="fa fa-heart"></i>
                                        243
                                    </button>
                                </div>
                                <div class="media media-comment">
                                    <a href="#" class="avatar avatar-danger pull-left">
                                        <img class="media-object" src="../assets/img/faces/face_4.jpg">
                                    </a>
                                    <div class="media-body">
                                        <h3 class="media-heading">Mike Tompson</h3>
                                        <h5 class="text-muted pull-right">Mar 23, 09:42 AM</h5>
                                        <p>If you’ve been around Dribbble, Behance, or any other design community lately, you’ve probably seen the recent trend of mixing flat design with big, beautiful diffused drop shadows. On the face of it, you might think, “That’s just a big drop shadow applied to a rectangle,” but you’d be sorely mistaken. </p>
                                        <div class="media-footer">
                                            <button class="btn btn-danger btn-simple pull-right">
                                                <i class="fa fa-heart fa-heart-o"></i>
                                                4
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="media">
                            <a href="#" class="avatar pull-left">
                                <img class="media-object" src="../assets/img/faces/face_1.jpg">
                            </a>
                            <div class="media-body">
                                <h3 class="media-heading">Creative Tim</h3>
                                <h5 class="text-muted pull-right">Sep 17, 07:53 PM</h5>
                                <p>If you’ve been around Dribbble, Behance, or any other design community lately, you’ve probably seen the recent trend of mixing flat design with big, beautiful diffused drop shadows. On the face of it, you might think, “That’s just a big drop shadow applied to a rectangle,” but you’d be sorely mistaken. </p>
                                <p>This video will show you how to make the perfect diffused shadow for your trendiest designs.</p>

                                <div class="media-footer">
                                    <button class="btn btn-info btn-simple">
                                        <i class="fa fa-reply"></i>
                                        Reply
                                    </button>
                                    <button class="btn btn-danger btn-simple pull-right">
                                        <i class="fa fa-heart-o"></i>
                                        243
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="container">
                <div class="contact-form">
                    <form action="" method="post">
                        <div class="row">
                            <div class="col-md-8">
                                <div class="form-group">
                                    <textarea name="content" class="form-control" placeholder="Here you can write your nice text" rows="8"></textarea>
                                </div>
                                <button type="button" class="btn btn-danger btn-fill pull-right">Post Comment</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div> -->


    <div class="section section-gray">
        <div class="container">
            <div class="title-area">
                <h5 class="subtitle text-gray">Don't miss our</h5>
                <h2>Most Recommended Stories</h2>
                <div class="separator separator-danger">✻</div>
            </div>
           <div class="row">
               <div class="col-md-4">
                   <div class="card card-blog">
                       <a href="#gaia" class="header">
                           <img src="assets/img/header-3.jpeg" class="image-header">
                       </a>
                       <div class="content">
                           <h6 class="card-date">Jul 27</h6>
                           <a href="#gaia" class="card-title">
                               <h3>How to Make the Perfect Statues</h3>
                           </a>
                           <div class="line-divider line-danger"></div>
                           <h6 class="card-category">Food & Drink</h6>
                       </div>
                   </div>
               </div>

                <div class="col-md-4">
                    <div class="card card-blog">
                        <a href="#gaia" class="header">
                            <img src="assets/img/header-6.jpeg" class="image-header">
                        </a>
                        <div class="content">
                            <h6 class="card-date">Feb 17</h6>
                            <a href="#gaia" class="card-title">
                                <h3>Nature & The Catch of the Day</h3>
                            </a>
                            <div class="line-divider line-danger"></div>
                            <h6 class="card-category">Nature</h6>
                        </div>
                    </div>
                    <div class="card card-blog">
                        <a href="#gaia" class="header">
                            <img src="assets/img/header-4.jpeg" class="image-header">
                        </a>
                        <div class="content">
                            <h6 class="card-date">Mar 27</h6>
                            <a href="#gaia" class="card-title">
                                <h3>Breathing in the Crisp Air of Lake Lucerne</h3>
                            </a>
                            <div class="line-divider line-danger"></div>
                            <h6 class="card-category">Business & Travel</h6>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card card-blog">
                        <div class="content">
                            <h2><i class="fa fa-twitter"></i></h2>

                            <a href="#gaia" class="card-title">
                                <h3>"Breathing in the Crisp Air of Lake Lucerne"</h3>
                            </a>
                            <div class="line-divider line-danger"></div>
                            <h6 class="card-category">Social Media</h6>
                        </div>
                    </div>
                    <div class="card card-blog">
                        <a href="#gaia" class="header">
                            <img src="assets/img/header-2.jpeg" class="image-header">
                        </a>
                        <div class="content">
                            <h6 class="card-date">Feb 17</h6>
                            <a href="#gaia" class="card-title">
                                <h3>17 Best Nature Images</h3>
                            </a>
                            <div class="line-divider line-danger"></div>
                            <h6 class="card-category">Images</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <footer class="footer footer-color-black" data-color="black">
        <div class="container">
            <nav class="pull-left">
                <ul>
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="about-us.html">About</a>
                    </li>
                    <li>
                        <a href="pricing.html">Pricing</a>
                    </li>
                    <li>
                        <a href="contact-us.html">Contact</a>
                    </li>
                </ul>
            </nav>
            <div class="social-area pull-right">
				<a  href="https://www.facebook.com/Dragomir2020/" class="btn btn-social btn-facebook btn-simple">
					<i class="fa fa-facebook-square"></i>
				</a>
				<a href="https://www.linkedin.com/company-beta/25166872/" class="btn btn-social btn-linkedin btn-simple">
					<i class="fa fa-linkedin"></i>
				</a>
				<a href="https://github.com/Dragomir2020" class="btn btn-social btn-github btn-simple">
					<i class="fa fa-github"></i>
				</a>
				<a href="https://plus.google.com/u/0/+DillonDragomir" class="btn btn-social btn-google btn-simple">
					<i class="fa fa-google-plus-square"></i>
				</a>
            </div>
            <div class="copyright">
                &copy; <script>document.write(new Date().getFullYear())</script>  Dillon Dragomir
            </div>
        </div>
    </footer>


</body>

<!--   core js files    -->
<script src="assets/js/jquery.min.js" type="text/javascript"></script>
<script src="assets/js/bootstrap.js" type="text/javascript"></script>
<!-- Prism - Used for code highlighting -->
<script src="assets/js/prism.js" type="text/javascript"></script>

<!--  js library for devices recognition -->
<script type="text/javascript" src="assets/js/modernizr.js"></script>

<!--  script for google maps   -->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js"></script>

<!--   file where we handle all the script from the Gaia - Bootstrap Template   -->
<script type="text/javascript" src="assets/js/gaia.js"></script>


</html>
